---
output: html_document
---

```{r}
# Load Palette
load(file = "C:/Users/skyep/Documents/Research/Plot_Animations/spalette.RData")
```

# Prelim Functions

## rekt
**Description:** Creates rectangle over plot region (acts as background colour)

**Parameters:** col (colour); log (warps rectangle to fit logarithmic axes)

**Notes:** Overlays current plot - you will have to replot the data unless rekt() is embedded in splot()


## sox
**Description:** Redraws border around plot region

**Parameters:** N/A

**Notes:** Useful for image plots


## skor
**Description:** Draws faint grid beneath the data: orientation lines similar to ggplot

**Parameters:** {x,y} (indep/dep variables: determines range); {n1,n2} (number of lines along x/y); col (colour)

**BUGS:** Skye, consider changing x/y to xlim/ylim somehow. Not currently flexible if user changes lims. 


## slab
**Description:** Adds Skye-designed labels to existing plot

**Parameters:** main (title); subb (subtitle); xlab (x axis label [duh]), ylab (y axis label)

**Notes:** Height ("line") of main title is dependent on whether a subtitle exists.


## rexs
**Description:** Draws a symmetrical pillarbox background

**Parameters:** N (length of x vector); B (combined width of pillars); col (colour)

**Notes:** Designed specifically to highlight boundary regions omitted by sliding window estimates


```{r prelim}

# --- Rectangle --- #
rekt <- function(col = skrown$smoke, log = FALSE){
  if(log == FALSE){
      rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = col)
  } else if(log == "x"){
      rect(10^par("usr")[1], par("usr")[3], 10^par("usr")[2], par("usr")[4], col = col)
  } else if(log == "y"){
      rect(par("usr")[1], 10^par("usr")[3], par("usr")[2], 10^par("usr")[4], col = col)
  } else if (log == "xy"){
      rect(10^par("usr")[1], 10^par("usr")[3], 10^par("usr")[2], 10^par("usr")[4], col = col)
  }
}

# --- box around plot --- #
sox <- function(col = skrown$B2){
  abline(v = c(par("usr")[1], par("usr")[2]),
         h = c(par("usr")[3], par("usr")[4])) }

# --- orientation lines --- #
skor <- function(x = 0, y = NULL, xlim = NULL, ylim = NULL, n1 = 11, n2 = 9, col = "white"){
  
  if(is.null(xlim)) {
    abline(v = seq(min(x), max(x), length.out = n1), col = col, lwd = 2)
  } else {
    abline(v = seq(xlim[1], xlim[2], length.out = n1), col = col, lwd = 2)
  }
  
  if(is.null(ylim) & is.null(y)){
    abline(h = seq(min(x), max(x), length.out = n2), col = col, lwd = 2)
  } else if(is.null(ylim)) {
    abline(h = seq(min(y), max(y,0), length.out = n2), col = col, lwd = 2)
  } else {
    abline(h = seq(ylim[1], ylim[2], length.out = n2), col = col, lwd = 2)
  }
  
  sox()
}

# --- Label Function --- # NORMALLY 1.7 is actually 1.5!!!!!!!!!!!!!!!!!!!
slab <- function(main = "", subb = "", xlab = "", ylab = "", col = skrown$B2){
  if(subb == ""){
            mtext(main, 3, 1,     font = 2, cex = 1.1, col = col)
    } else {mtext(main, 3, 1.75,  font = 2, cex = 1.1, col = col )}
  mtext(subb, 3, 0.28,           cex = 1   , col = col)
  mtext(xlab, 1, 2.75, font = 1, cex = 1.05, col = col)
  mtext(ylab, 2, 3.5 , font = 1, cex = 1.05, col = col)
}

```

# Splot: Skye-Plots

| Parameter | Description                                                                                                     |
|:----------|:----------------------------------------------------------------------------------------------------------------|
| x, y      | Independent and dependent variables to plot, respectively                                                       |
| col       | Data will be plotted in this colour                                                                             |
| main, subb, xlab, ylab | title, subtitle, and axis labels. Title height dependent on existence of subtitle.                 |
| type      | plot type (lines, points, heights, connect-the-dots, etc.)                                                      |
| pch       | point character                                                                                                 |
| colr      | background colour for plot region (to be drawn by rekt())                                                       |
| skor      | Indicates whether to draw grid of orientation lines (similar to ggplot)                                         |
| n1,n2     | numbers of vertical and horizontal orientation lines if skor=TRUE                                               |
| skorcol   | colour of orientation lines if skor=TRUE                                                                        |
| log       | logarithmic axes (sends to main plot but also the rekt)                                                         |
| labs      | should x and y labels be automatically produced via substitute()? OPT-IN rather than OPT-OUT                    |
| las       | defines how axis tick labels are oriented (default is upright for both axes)                                    |
| ...       | other graphical parameters                                                                                      |

```{r}
# --- Skye-Plot function --- #
splot <- function(x, y = NULL,
                  col  = skrown$B2,
                  main = "", subb = "", xlab = "", ylab = "",
                  type = "p", pch = 19,
                  colr = skrown$smoke,
                  xlim = NULL, ylim = NULL,
                  skor = TRUE, n1 = 11, n2 = 9, skorcol = "white",
                  log  = FALSE,
                  labs = FALSE, las = 1, ...){
  # frame
  plot(x, y, xlab = "", ylab = "", las = las,
       xlim = xlim, ylim = ylim, ...)
  
  # bg
  rekt(colr, log) 
  
  # orient
  if(skor)(skor(x, y, xlim, ylim, n1, n2, skorcol))
  
  # add
  if(type == "p"){points(x, y, col = col, pch = pch, ...)
  } else {
    lines(x, y, col = col, type = type, ...)
  }
  
  # Labels
  if(labs){slab(main,subb,xlab = substitute(x),ylab = substitute(y))} else {slab(main,subb,xlab,ylab)}
}
```

## Skye's wishlist to herself

* legend function... what can I automate? Can I enter a dataframe maybe? Set default colours?

---

### Old buggy functions I don't really use anymore (but probably will have to revive soon)

```{r}
# --- define inner function: pillarbox 
rext <- function(N=1000,B=100, col = skrown$b1){rect(
     xleft = c(par("usr")[[1]],N-ceiling(B/2)),
     ybottom = c(par("usr")[[3]], par("usr")[[3]]),
     xright = c(ceiling(B/2), par("usr")[[2]]),
     ytop = c(par("usr")[[4]], par("usr")[[4]]),
     col = col, border = NA)}

# --- within splot
# requires B, N, bord, skol
if(rexs){
    rext(length(x),bord)
    abline(v = c(ceiling(B/2),N-ceiling(B/2)), col = skol$green, lty = 2)
    abline(v=c(par("usr")[1]),#par("usr")[3]),
           h=par("usr")[4]) 
  }
```




```{r}
save.image("C:/Users/skyep/Documents/Research/Plot_Animations/splot.RData")   # General plot directory
```
